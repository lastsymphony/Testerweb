<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>JSON Generator + Catbox Uploader</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f5f5f5; }
    input, select { padding: 5px; margin: 5px 0; width: 100%; }
    textarea { width: 100%; height: 120px; margin-top: 10px; }
    button { padding: 10px 15px; margin-top: 10px; background: #4caf50; color: #fff; border: none; cursor: pointer; }
    button:hover { background: #45a049; }
    .copy-btn { background: #2196f3; }
    .copy-btn:hover { background: #1976d2; }
    .container { max-width: 500px; margin: auto; background: #fff; padding: 20px; border-radius: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>JSON + Catbox Uploader</h2>

    <label>Title:</label>
    <input type="text" id="title" placeholder="contoh: guaxichan">

    <label>File Upload (image/video/doc):</label>
    <input type="file" id="fileUpload">

    <label>Category:</label>
    <select id="category">
      <option value="image">image</option>
      <option value="video">video</option>
      <option value="document">document</option>
      <option value="audio">audio</option>
    </select>

    <label>Upload Date:</label>
    <input type="datetime-local" id="upload">

    <button onclick="uploadAndGenerate()">Upload ke Catbox & Generate JSON</button>

    <textarea id="result" readonly placeholder="Hasil JSON muncul di sini..."></textarea>
    <button class="copy-btn" onclick="copyResult()">ðŸ“‹ Copy</button>
  </div>

  <script>
    async function uploadAndGenerate() {
      const title = document.getElementById("title").value;
      const fileInput = document.getElementById("fileUpload");
      const category = document.getElementById("category").value;
      const uploadRaw = document.getElementById("upload").value;
      const uploadDate = uploadRaw ? new Date(uploadRaw).toISOString() : new Date().toISOString();

      if (fileInput.files.length === 0) {
        alert("Pilih file dulu!");
        return;
      }

      const formData = new FormData();
      formData.append("reqtype", "fileupload");
      formData.append("fileToUpload", fileInput.files[0]);

      try {
        const response = await fetch("https://catbox.moe/user/api.php", {
          method: "POST",
          body: formData
        });

        const fileURL = await response.text();

        const jsonData = {
          title: title,
          url: fileURL,
          category: category,
          upload: uploadDate
        };

        document.getElementById("result").value = JSON.stringify(jsonData, null, 2);

      } catch (error) {
        alert("Upload gagal: " + error);
      }
    }

    function copyResult() {
      const resultArea = document.getElementById("result");
      resultArea.select();
      resultArea.setSelectionRange(0, 99999);
      document.execCommand("copy");
    }
  </script>
</body>
</html>
